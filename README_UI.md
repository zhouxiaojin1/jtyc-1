# 交通流量预测系统 - 可视化界面

##120

## 📖 简介

这是一个基于Streamlit开发的交通流量预测系统可视化界面，提供完整的数据预处理、模型训练和结果分析功能。

## ✨ 功能特性

### 1. 🏠 首页
- 系统概览和快速导航
- 系统状态监控
- 最近活动记录

### 2. 📊 数据预处理
- **数据加载**
  - 支持CSV格式数据
  - 数据概览和基本统计
  - 列信息详情

- **缺失值处理**
  - 多种填充方法（前向填充、后向填充、插值等）
  - 缺失值可视化
  - 批量处理

- **异常检测**
  - IQR方法、Z-Score方法、MAD方法
  - 异常值可视化
  - 多种处理策略

- **数据探索**
  - 时间序列可视化
  - 分布分析
  - 相关性分析
  - 统计摘要

### 3. 🤖 模型训练
- **支持的模型**
  - ⚡ LightGBM：快速梯度提升树
  - 🧠 LSTM：长短期记忆网络
  - 🚀 N-HiTS：多尺度分层插值
  - 📈 TBATS：多季节指数平滑
  - 🔮 Chronos：预训练时序大模型

- **参数配置**
  - 通用参数（预测步数、历史窗口等）
  - 模型特定参数
  - 实时参数验证

- **训练监控**
  - 实时日志输出
  - 训练进度显示
  - 结果文件管理

### 4. 📈 结果分析
- **预测结果**
  - 预测数据展示
  - 评估指标统计
  - 预测曲线可视化

- **模型对比**
  - 多模型性能对比
  - 指标可视化
  - 区域级详细对比

- **详细分析**
  - 预测统计分析
  - 区域性能分析
  - 误差分布分析
  - Markdown报告导出

### 5. ⚙️ 系统设置
- **系统信息**
  - Python环境信息
  - PyTorch和CUDA信息
  - GPU详细信息
  - 已安装包列表

- **文件管理**
  - 数据集管理
  - 输出文件管理
  - 批量清理功能

- **缓存管理**
  - Session State管理
  - Streamlit缓存清理
  - GPU显存清理

- **关于页面**
  - 系统介绍
  - 功能特性
  - 技术栈
  - 系统健康检查

## 🚀 快速开始

### 环境要求

- Python 3.8+
- Conda（推荐）
- 已安装的依赖包（见requirements.txt）

### 安装步骤

1. **创建并激活conda环境**
```bash
conda create -n ap python=3.12
conda activate ap
```

2. **安装依赖**
```bash
# 安装PyTorch CPU版本
conda install pytorch torchvision cpuonly -c pytorch -y

# 安装其他依赖
conda install pandas scikit-learn matplotlib seaborn tqdm -y

# 安装额外的包
pip install streamlit lightgbm tbats pmdarima
pip install git+https://github.com/amazon-science/chronos-forecasting.git
```

3. **启动应用**

**方式1：使用批处理脚本（Windows）**
```bash
run_app.bat
```

**方式2：直接启动**
```bash
conda activate ap
streamlit run app.py
```

4. **访问应用**

应用启动后会自动在浏览器打开，或手动访问：
```
http://localhost:8501
```

## 📁 项目结构

```
F:\jtyc\new\
├── app.py                    # 主应用入口
├── ui/                       # UI模块
│   ├── __init__.py
│   ├── data_preprocessing.py # 数据预处理页面
│   ├── model_training.py     # 模型训练页面
│   ├── result_analysis.py    # 结果分析页面
│   └── system_settings.py    # 系统设置页面
├── predict/                  # 模型脚本
│   ├── model_lightgbm.py
│   ├── model_lstm.py
│   ├── model_nhits.py
│   ├── model_tbats.py
│   └── model_chronos.py
├── dataprecess/              # 数据预处理脚本
├── dataset/                  # 数据集
├── output/                   # 输出文件
├── requirements.txt          # 依赖列表
├── run_app.bat              # Windows启动脚本
└── README_UI.md             # 本文档
```

## 📝 使用指南

### 1. 数据预处理流程

1. 进入"📊 数据预处理"页面
2. 在"数据加载"选项卡中选择数据集并加载
3. 根据需要进行缺失值处理和异常检测
4. 使用数据探索功能了解数据特征
5. 保存处理后的数据（可选）

### 2. 模型训练流程

1. 进入"🤖 模型训练"页面
2. 选择要使用的预测模型
3. 配置模型参数：
   - 设置预测步数和历史窗口长度
   - 调整模型特定参数
4. 点击"🚀 开始训练"按钮
5. 等待训练完成，查看生成的文件

### 3. 结果分析流程

1. 进入"📈 结果分析"页面
2. 在"预测结果"选项卡查看单个模型的结果
3. 在"模型对比"选项卡对比多个模型的性能
4. 在"详细分析"选项卡进行深入分析
5. 导出分析报告（可选）

## 🎯 模型选择建议

### LightGBM
- ✅ **适用场景**：快速验证、特征工程
- ✅ **优点**：训练快、资源占用低
- ❌ **缺点**：长期预测误差可能累积

### LSTM
- ✅ **适用场景**：经典时序预测任务
- ✅ **优点**：捕捉长期依赖、性能稳定
- ❌ **缺点**：训练时间较长

### N-HiTS
- ✅ **适用场景**：长期预测、多季节性数据
- ✅ **优点**：最新模型、效果好
- ❌ **缺点**：需要GPU加速

### TBATS
- ✅ **适用场景**：多季节性数据、可解释性需求
- ✅ **优点**：传统方法、稳定可靠
- ❌ **缺点**：无法利用跨区域信息

### Chronos
- ✅ **适用场景**：零样本预测、快速部署
- ✅ **优点**：预训练模型、泛化能力强
- ❌ **缺点**：模型较大、资源占用高

## 🔧 性能优化建议

### CPU模式
- 适合：小规模数据、快速实验
- 建议：使用LightGBM、TBATS
- 限制：深度学习模型训练较慢

### GPU模式
- 适合：大规模数据、深度学习模型
- 建议：使用LSTM、N-HiTS、Chronos
- 注意：确保CUDA兼容性

## ❓ 常见问题

### Q1: 如何切换到GPU模式？

A: 安装GPU版本的PyTorch：
```bash
conda install pytorch torchvision pytorch-cuda=11.8 -c pytorch -c nvidia
```

### Q2: 训练时出现内存不足怎么办？

A: 尝试以下方法：
- 减少批次大小（batch_size）
- 减少历史窗口长度
- 选择更小的模型
- 减少训练的区域数量

### Q3: 如何导出预测结果？

A: 所有结果自动保存在`output/`目录下，可以：
- 在结果分析页面使用下载按钮
- 直接在`output/`目录中找到CSV文件

### Q4: 如何添加自定义数据集？

A: 将CSV文件放入`dataset/`目录，格式要求：
- 第一列为时间列
- 其他列为不同区域的数值数据

### Q5: 如何清理旧的训练结果？

A: 进入"⚙️ 系统设置" > "文件管理"，使用清理功能

## 🐛 故障排除

### 应用无法启动
1. 确认conda环境已激活
2. 检查streamlit是否已安装
3. 查看终端错误信息

### 模型训练失败
1. 检查数据集是否正确加载
2. 确认模型脚本存在
3. 查看训练日志中的错误信息

### GPU不可用
1. 检查CUDA是否正确安装
2. 确认PyTorch版本与CUDA版本匹配
3. 在系统设置中查看GPU信息

## 📞 技术支持

如遇到问题，请：
1. 查看系统设置中的健康检查结果
2. 查阅本文档的常见问题部分
3. 检查终端输出的错误信息

## 📄 更新日志

### v1.0.0 (2024-11-14)
- ✨ 初始版本发布
- 📊 完整的数据预处理功能
- 🤖 支持5种预测模型
- 📈 丰富的结果分析工具
- ⚙️ 系统管理和监控功能

## 📜 许可证

本项目仅供学习和研究使用。

---

**© 2024 交通流量预测系统**
